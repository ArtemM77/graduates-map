<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Где заморозить сперму кобеля?</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    html, body, #map {
      margin: 0;
      padding: 0;
      height: 100%;
      width: 100%;
    }
    .ol-popup {
      background: white;
      border: 1px solid #ccc;
      padding: 15px;
      border-radius: 8px;
      max-width: 90vw;
      max-height: 85vh;
      overflow-y: auto;
      font-family: sans-serif;
      font-size: 13px;
      color: #222;
    }
    .ol-popup img {
      max-width: 100%;
      border-radius: 4px;
    }
    .contact-buttons a, .icon-links a {
      display: block;
      background: white;
      border: 1px solid #ccc;
      border-radius: 6px;
      padding: 8px 10px;
      font-size: 10px;
      text-decoration: none;
      color: black;
      text-align: center;
      margin-bottom: 5px;
    }
    .icon-links {
      display: flex;
      justify-content: center;
      gap: 12px;
      margin-top: 10px;
    }
    .icon-links img {
      width: 50px;
      height: 50px;
    }
  </style>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ol@v7.3.0/ol.css">
  <script src="https://cdn.jsdelivr.net/npm/ol@v7.3.0/dist/ol.js"></script>
</head>
<body>
  <div id="map"></div>
  <script>
    // Логирование событий
    function logDoctorView(name, event = "card_opened") {
      const url = "https://script.google.com/macros/s/AKfycbyFyGbiTvE-9CnTgMKBYxx70cXgtXiaE3KW1-2GzMuPVTvRz5FasnQ7aOdkq2hnB9t1/exec";
      fetch(url, {
        method: "POST",
        mode: "no-cors",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          name,
          event,
          timestamp: new Date().toISOString()
        })
      }).catch(() => {});
    }

    const doctors = [
      {
        name: "Софья Богданова",
        city: "Санкт-Петербург",
        clinic_logo: "cryovet.png",
        photo: "bogdanova.png",
        clinic: "Криовет",
        address: "Пушкин Московская 10",
        lat: 59.721363,
        lng: 30.401954,
        phone: "+79213945667",
        site: "https://cryovet.ru/",
        title: "врач-репродуктолог лаборатории",
        services: "-спермограмма<br>-приготовление охлажденной спермы<br>-криоконсервация спермы<br>-доставка охлажденной и замороженной спермы<br>-выезд в регионы<br>-искусственное осеменение<br>-услуги криобанка<br>-консультативные услуги<br>-проведение мастер-классов<br>"
      },
      {
        name: "Анастасия Замятина",
        city: "Нижний Новгород",
        clinic_logo: "veteco.png",
        photo: "zamiyatina.png",
        clinic: "ВетЭко",
        address: "Родионова 193",
        lat: 56.301844,
        lng: 44.076147,
        phone: "+79012487829",
        site: "https://vet-eko.ru/",
        title: "руководитель, врач-репродуктолог ветеринарной клиники",
        services: "-спермограмма<br>-приготовление охлажденной спермы<br>-криоконсервация спермы<br>-искусственное осеменение<br>-услуги криобанка"
      }
      {
        name: "Анастасия Манторова",
        city: "Минск",
        clinic_logo: "bazylevskiy.png",
        photo: "mantorova.png",
        clinic: "доктора Базылевского А.А.",
        address: "Железнодорожная 31",
        lat: 53.873812,
        lng: 27.502037,
        phone: "+375333263000",
        site: "https://minsk.vet-centre.by/",
        title: "врач-репродуктолог ветеринарного центра",
        services: "-спермограмма<br>-приготовление охлажденной спермы<br>-криоконсервация спермы<br>-искусственное осеменение<br>-услуги криобанка"
      },
      {
        name: "Александра Каменская",
        city: "Самара",
        clinic_logo: "crocozoo.png",
        photo: "kamenskaya.png",
        clinic: "Крокозоо",
        address: "Самара Ленина 1",
        lat: 53.204967,
        lng: 50.132739,
        phone: "+79677620010",
        site: "https://crocozoo.ru/",
        title: "главный врач, врач-репродуктолог ветеринарной клиники",
        services: "-спермограмма<br>-приготовление охлажденной спермы<br>-криоконсервация спермы<br>-искусственное осеменение<br>-услуги криобанка"
      },
      {
        name: "Марина Сажнева",
        city: "Санкт-Петербург",
        clinic_logo: "doctorgil.png",
        photo: "sajneva.png",
        clinic: "доктора Гиль",
        address: "Энергетиков 70",
        lat: 59.972196,
        lng: 30.435014,
        phone: "+79311094880",
        site: "https://gilvet.ru/",
        title: "врач-репродуктолог ветеринарной клиники",
        services: "-спермограмма<br>-приготовление охлажденной спермы<br>-криоконсервация спермы<br>-искусственное осеменение<br>-услуги криобанка"
      },
      {
        name: "Анастасия Кормакова",
        city: "Санкт-Петербург",
        clinic_logo: "doctorpets.png",
        photo: "kormakova.png",
        clinic: "Dr.Pets",
        address: "Коллонтай 30",
        lat: 59.924440,
        lng: 30.483934,
        phone: "+78126467626",
        site: "https://dr-pets.ru/",
        title: "врач-репродуктолог сети ветеринарных клиник",
        services: "-спермограмма<br>-приготовление охлажденной спермы<br>-криоконсервация спермы<br>-искусственное осеменение<br>-услуги криобанка"
      },
      {
        name: "Татьяна Калмыкова",
        city: "Санкт-Петербург",
        clinic_logo: "vega.png",
        photo: "kalmykova.png",
        clinic: "Вега",
        address: "Пулковская 11",
        lat: 59.838007,
        lng: 30.348725,
        phone: "+78124997701",
        site: "https://vegavet.spb.ru/",
        title: "врач-репродуктолог сети ветеринарных клиник",
        services: "-спермограмма<br>-приготовление охлажденной спермы<br>-криоконсервация спермы<br>-искусственное осеменение<br>-услуги криобанка"
      },
      {
        name: "Анна Василевская",
        city: "Новосибирск",
        clinic_logo: "interra.png",
        photo: "vasilevskaya.png",
        clinic: "ИнТерра",
        address: "Новосибирск Выставочная 15",
        lat: 54.993255,
        lng: 82.892859,
        phone: "+73833830949",
        site: "https://vet-interra.ru/",
        title: "врач-репродуктолог сети ветеринарных клиник",
        services: "-спермограмма<br>-приготовление охлажденной спермы<br>-криоконсервация спермы<br>-искусственное осеменение<br>-услуги криобанка"
      },
      {
        name: "Светлана Сенчукова",
        city: "Новосибирск",
        clinic_logo: "interra.png",
        photo: "senchukova.png",
        clinic: "ИнТерра",
        address: "Новосибирск Высоцкого 49",
        lat: 55.029920,
        lng: 83.020497,
        phone: "+73833830949",
        site: "https://vet-interra.ru/",
        title: "врач-репродуктолог сети ветеринарных клиник",
        services: "-спермограмма<br>-приготовление охлажденной спермы<br>-криоконсервация спермы<br>-искусственное осеменение<br>-услуги криобанка"
      },
      {
        name: "Ирина Сокирко",
        city: "Омск",
        clinic_logo: "aveta.png",
        photo: "sokirko.png",
        clinic: "Авета",
        address: "Омск 10 лет Октября 141",
        lat: 54.987021,
        lng: 73.416386,
        phone: "+79136718689",
        site: "https://avetaomsk.orgs.biz/",
        title: "главный врач, врач-репродуктолог ветеринарной клиники",
        services: "-спермограмма<br>-приготовление охлажденной спермы<br>-криоконсервация спермы<br>-искусственное осеменение<br>-услуги криобанка"
      },
      {
        name: "Алексей Смычков",
        city: "Рига",
        clinic_logo: "kalnberzs.png",
        photo: "",
        clinic: "Kalnbērzs",
        address: "Slokas iela 163a",
        lat: 56.959893,
        lng: 24.031668,
        phone: "+371 67425686",
        site: "www.vet-klinika.lv",
        title: "ассистент врача-репродуктолога ветеринарной клиники",
        services: "-спермограмма<br>-приготовление охлажденной спермы<br>-криоконсервация спермы<br>-услуги криобанка"
      },
      {
        name: "Татьяна Прохорова",
        city: "Воронеж",
        clinic_logo: "zdoroviezivotnyh.png",
        photo: "prohorova.png",
        clinic: "Здоровье Животных",
        address: "Воронеж Волгоградская 44",
        lat: 51.650237,
        lng: 39.268304,
        phone: "+79525566588",
        site: "https://zdorovet.ru/",
        title: "врач-репродуктолог сети ветеринарных клиник",
        services: "-спермограмма<br>-приготовление охлажденной спермы<br>-криоконсервация спермы<br>-искусственное осеменение<br>-услуги криобанка"
      },
      {
        name: "Мария Богачева",
        city: "Владимир",
        clinic_logo: "dobriydoctor.png",
        photo: "bogacheva.png",
        clinic: "Добрый Доктор",
        address: "Владимир Луначарского 23",
        lat: 56.137003,
        lng: 40.415575,
        phone: "+74922771424",
        site: "https://dobrydoctora.ru/",
        title: "врач-репродуктолог ветеринарной клиники",
        services: "-спермограмма<br>-приготовление охлажденной спермы<br>-криоконсервация спермы<br>-искусственное осеменение<br>-услуги криобанка"
      },
      {
        name: "Екатерина Слижевская",
        city: "Санкт-Петербург",
        clinic_logo: "altervet.png",
        photo: "slijevskaya.png",
        clinic: "Альтервет",
        address: "Художников 11",
        lat: 60.036190,
        lng: 30.346180,
        phone: "+78126144040",
        site: "https://altervet.com/",
        title: "врач-репродуктолог ветеринарной клиники ",
        services: "-спермограмма<br>-приготовление охлажденной спермы<br>-криоконсервация спермы<br>-искусственное осеменение<br>-услуги криобанка"
      },
      // ...добавим остальных позже
    ];

    const view = new ol.View({
      center: ol.proj.fromLonLat([50.5, 56.5]),
      zoom: 4
    });

    const map = new ol.Map({
      target: 'map',
      layers: [
        new ol.layer.Tile({ source: new ol.source.OSM() })
      ],
      view: view
    });

    const overlay = new ol.Overlay({
      element: document.createElement('div'),
      autoPan: true,
      autoPanAnimation: { duration: 250 }
    });
    map.addOverlay(overlay);

    doctors.forEach(doc => {
      const iconFeature = new ol.Feature({
        geometry: new ol.geom.Point(ol.proj.fromLonLat([doc.lng, doc.lat])),
        doctor: doc
      });

      const iconStyle = new ol.style.Style({
        image: new ol.style.Icon({
          src: `https://artemm77.github.io/graduates-map/${doc.clinic_logo}`,
          scale: 0.5,
          anchor: [0.5, 1]
        })
      });
      iconFeature.setStyle(iconStyle);

      const vectorSource = new ol.source.Vector({ features: [iconFeature] });
      const vectorLayer = new ol.layer.Vector({ source: vectorSource });
      map.addLayer(vectorLayer);
    });

    map.on('singleclick', function (evt) {
      map.forEachFeatureAtPixel(evt.pixel, function (feature) {
        const doctor = feature.get('doctor');
        const element = overlay.getElement();
        element.className = 'ol-popup';
        element.innerHTML = `
          <img src="https://artemm77.github.io/graduates-map/${doctor.photo}" />
          <h3 style="margin: 10px 0 0 0; font-size: 15px;">${doctor.name}</h3>
          <p style="margin: 0;">${doctor.title}<br><strong>${doctor.clinic}</strong></p>
          <p style="margin-top: 10px;"><span style="text-decoration: underline;">Услуги по репродукции:</span><br>${doctor.services}</p>
          <div class="contact-buttons">
            <a href="https://yandex.ru/maps/?text=${doctor.address}" target="_blank">${doctor.address}</a>
            <a href="tel:${doctor.phone}">📞 ${doctor.phone}</a>
            <a href="${doctor.site}" target="_blank">🌐 Перейти на сайт</a>
          </div>
          <div class="icon-links">
            <a href="yandexnavi://build_route_on_map?lat_to=${doctor.lat}&lon_to=${doctor.lng}"><img src="https://artemm77.github.io/graduates-map/yandex.png"></a>
            <a href="https://wa.me/${doctor.phone.replace(/[^0-9]/g, '')}"><img src="https://artemm77.github.io/graduates-map/whatsapp.png"></a>
            <a href="https://t.me/${doctor.phone.replace(/[^0-9]/g, '')}"><img src="https://artemm77.github.io/graduates-map/telegram.png"></a>
          </div>
        `;
        overlay.setPosition(evt.coordinate);
        logDoctorView(doctor.name);
      });
    });
  </script>
</body>
</html>
